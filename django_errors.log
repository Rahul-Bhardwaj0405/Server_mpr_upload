Internal Server Error: /
Traceback (most recent call last):
  File "E:\Bulk_V1\env\Lib\site-packages\redis\connection.py", line 534, in send_packed_command
    self._sock.sendall(item)
    ~~~~~~~~~~~~~~~~~~^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Bulk_V1\env\Lib\site-packages\kombu\connection.py", line 472, in _reraise_as_library_errors
    yield
  File "E:\Bulk_V1\env\Lib\site-packages\kombu\connection.py", line 556, in _ensured
    return fun(*args, **kwargs)
  File "E:\Bulk_V1\env\Lib\site-packages\kombu\messaging.py", line 208, in _publish
    return channel.basic_publish(
           ~~~~~~~~~~~~~~~~~~~~~^
        message,
        ^^^^^^^^
    ...<2 lines>...
        timeout=timeout
        ^^^^^^^^^^^^^^^
    )
    ^
  File "E:\Bulk_V1\env\Lib\site-packages\kombu\transport\virtual\base.py", line 614, in basic_publish
    return self._put(routing_key, message, **kwargs)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Bulk_V1\env\Lib\site-packages\kombu\transport\redis.py", line 1024, in _put
    client.lpush(self._q_for_pri(queue, pri), dumps(message))
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Bulk_V1\env\Lib\site-packages\redis\commands\core.py", line 2728, in lpush
    return self.execute_command("LPUSH", name, *values)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Bulk_V1\env\Lib\site-packages\redis\client.py", line 559, in execute_command
    return self._execute_command(*args, **options)
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "E:\Bulk_V1\env\Lib\site-packages\redis\client.py", line 567, in _execute_command
    return conn.retry.call_with_retry(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        lambda: self._send_command_parse_response(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        lambda error: self._disconnect_raise(conn, error),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "E:\Bulk_V1\env\Lib\site-packages\redis\retry.py", line 65, in call_with_retry
    fail(error)
    ~~~~^^^^^^^
  File "E:\Bulk_V1\env\Lib\site-packages\redis\client.py", line 571, in <lambda>
    lambda error: self._disconnect_raise(conn, error),
                  ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "E:\Bulk_V1\env\Lib\site-packages\redis\client.py", line 555, in _disconnect_raise
    raise error
  File "E:\Bulk_V1\env\Lib\site-packages\redis\retry.py", line 62, in call_with_retry
    return do()
  File "E:\Bulk_V1\env\Lib\site-packages\redis\client.py", line 568, in <lambda>
    lambda: self._send_command_parse_response(
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        conn, command_name, *args, **options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ),
    ^
  File "E:\Bulk_V1\env\Lib\site-packages\redis\client.py", line 541, in _send_command_parse_response
    conn.send_command(*args, **options)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "E:\Bulk_V1\env\Lib\site-packages\redis\connection.py", line 556, in send_command
    self.send_packed_command(
    ~~~~~~~~~~~~~~~~~~~~~~~~^
        self._command_packer.pack(*args),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        check_health=kwargs.get("check_health", True),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "E:\Bulk_V1\env\Lib\site-packages\redis\connection.py", line 545, in send_packed_command
    raise ConnectionError(f"Error {errno} while writing to socket. {errmsg}.")
redis.exceptions.ConnectionError: Error 10054 while writing to socket. An existing connection was forcibly closed by the remote host.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\Bulk_V1\env\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "E:\Bulk_V1\env\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "E:\Bulk_V1\bulk\upload\views.py", line 67, in upload_files
    process_uploaded_files.delay(file_contents, bank_name, transaction_type, file_formats, merchant_name)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Bulk_V1\env\Lib\site-packages\celery\app\task.py", line 444, in delay
    return self.apply_async(args, kwargs)
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "E:\Bulk_V1\env\Lib\site-packages\celery\app\task.py", line 594, in apply_async
    return app.send_task(
           ~~~~~~~~~~~~~^
        self.name, args, kwargs, task_id=task_id, producer=producer,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        **options
        ^^^^^^^^^
    )
    ^
  File "E:\Bulk_V1\env\Lib\site-packages\celery\app\base.py", line 801, in send_task
    amqp.send_task_message(P, name, message, **options)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Bulk_V1\env\Lib\site-packages\celery\app\amqp.py", line 518, in send_task_message
    ret = producer.publish(
        body,
    ...<7 lines>...
        **properties
    )
  File "E:\Bulk_V1\env\Lib\site-packages\kombu\messaging.py", line 186, in publish
    return _publish(
        body, priority, content_type, content_encoding,
        headers, properties, routing_key, mandatory, immediate,
        exchange_name, declare, timeout
    )
  File "E:\Bulk_V1\env\Lib\site-packages\kombu\connection.py", line 553, in _ensured
    with self._reraise_as_library_errors():
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\pguser\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "E:\Bulk_V1\env\Lib\site-packages\kombu\connection.py", line 476, in _reraise_as_library_errors
    raise ConnectionError(str(exc)) from exc
kombu.exceptions.OperationalError: Error 10054 while writing to socket. An existing connection was forcibly closed by the remote host.
